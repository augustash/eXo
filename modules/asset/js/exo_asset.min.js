/*
* eXo - text editor of awesomeness for Drupal
* by JaceRider and contributors. Available under the MIT license.
* See http://ashenrayne.com for more information
*
* Hallo 1.0.4 - rich text editor for jQuery UI
* by Henri Bergius and contributors. Available under the MIT license.
* See http://hallojs.org for more information
*/
(function(){!function(a){return Drupal.ajax.prototype.commands.exoAssetSet=function(b){var c,d;return c=a("#exo-body"),d=a(b.element).closest(".exo-asset"),c.exoPane("assetSet",d)},Drupal.ajax.prototype.commands.exoAssetUpdate=function(b,c){var d;return d=a("#exo-body"),d.exoPane("assetUpdate",c.aid,c.iid)},a.widget("EXO.exoPane",a.EXO.exoPane,{asset:null,assetSet:function(a){return this.asset=a},assetUpdate:function(a,b){var c,d;return c=Drupal.settings.exoAssets[a+"-"+b],this.asset.replaceWith(c),d=Drupal.settings,Drupal.attachBehaviors(this.asset,d)}}),this.Drupal.behaviors.exoAsset={attach:function(){return a(".exo-asset-remove").once("exo").click(function(b){var c;return b.preventDefault(),c=a(this).closest(".exo-asset"),c.remove()})}},a.widget("EXO.exoAssets",{$exo:null,_create:function(){return this.$exo=this.options.$exo,this.$exo.on("exoEnable",this._tokenToAsset),this.$exo.on("exoDisable",this._assetToToken),this.element.on("exoDragonInsert",this._assetSwap),parent.Drupal.settings&&parent.Drupal.settings.exoAssets?Drupal.settings.exoAssets=parent.Drupal.settings.exoAssets:void 0},_assetSwap:function(b){var c,d,e,f;return c=a(b.dragon.content),c.hasClass("asset-select")&&(d=c.attr("data-aid"),f=c.attr("data-iid"),e=d+"-"+f,Drupal.settings&&Drupal.settings.exoAssets&&Drupal.settings.exoAssets[e])?b.dragon.content=Drupal.settings.exoAssets[e]:void 0},_tokenToAsset:function(a){var b,c;return b=a.exo.content,c=function(a){var b,c;return c=new RegExp("(\\[asset-[0-9]+(-[0-9]+)?\\])","g"),b=void 0,a=a.replace(c,function(a,b){var d,e,f,g,h;return c=new RegExp("\\[asset-([0-9]+)-?([0-9]+)?\\]",["i"]),h=a.match(c),d=h[1],g=h[2]?h[2]:0,f=d+"-"+g,Drupal.settings&&Drupal.settings.exoAssets&&Drupal.settings.exoAssets[f]?(e=Drupal.settings.exoAssets[f],b.replace(c,e)):void 0})},a.exo.content=c(b)},_assetToToken:function(b){var c;return c=b.exo.content.clone(),a(".exo-asset",c).each(function(){var b,c,d;return b=a(this),c=b.attr("data-aid"),d=b.attr("data-iid"),b.replaceWith("[asset-"+c+"-"+d+"]")}),b.exo.content=c},populateSidebar:function(){var b,c,d,e,f;e=this.options.assets,f=[];for(c in e)d=e[c],b=a('<div id="'+this.widgetName+"-"+c+'" class="exo-button-wrapper"></div>'),a.extend(d,{$exo:this.$exo,$sidebar:this.element,plugin:this,id:c,asset:c}),b.exoSidebarButton(d),f.push(b.appendTo(this.element));return f},populateSidebarContent:function(a,b){var c,d;return c=a.attr("id"),d={url:"/exo/assets/"+b.asset+"/all/ajax",event:"onload",keypress:!1,prevent:!1,wrapper:c,progress:{type:"none"}},Drupal.ajax[c]=new Drupal.ajax(c,a,d),a.trigger("onload")}})}(jQuery)}).call(this);