// Generated by CoffeeScript 1.6.2
module.exports = function() {
  var banner;

  banner = "/*\n* eXo - text editor of awesomeness for Drupal\n* by JaceRider and contributors. Available under the MIT license.\n* See http://ashenrayne.com for more information\n*\n* Hallo <%= pkg.version %> - rich text editor for jQuery UI\n* by Henri Bergius and contributors. Available under the MIT license.\n* See http://hallojs.org for more information\n*/\n";
  this.initConfig({
    pkg: this.file.readJSON('package.json'),
    bower: {
      install: {}
    },
    coffee: {
      core: {
        expand: true,
        src: ['**.coffee'],
        dest: 'tmp/hallo',
        cwd: 'hallo',
        ext: '.js'
      },
      toolbar: {
        expand: true,
        src: ['**.coffee'],
        dest: 'tmp/hallo/toolbar',
        cwd: 'hallo/toolbar',
        ext: '.js'
      },
      widgets: {
        expand: true,
        src: ['**.coffee'],
        dest: 'tmp/hallo/widgets',
        cwd: 'hallo/widgets',
        ext: '.js'
      },
      plugins: {
        expand: true,
        src: ['**.coffee'],
        dest: 'tmp/hallo/plugins',
        cwd: 'hallo/plugins',
        ext: '.js'
      },
      plugins_image: {
        expand: true,
        src: ['**.coffee'],
        dest: 'tmp/hallo/plugins/image',
        cwd: 'hallo/plugins/image',
        ext: '.js'
      },
      exo: {
        expand: true,
        src: ['**.coffee'],
        dest: 'tmp/exo',
        cwd: 'exo',
        ext: '.js'
      }
    },
    watch: {
      full: {
        files: ['*/*.coffee', '*/*/*.coffee'],
        tasks: 'build'
      }
    },
    concat: {
      options: {
        stripBanners: true,
        banner: banner
      },
      full: {
        src: ['tmp/hallo/*.js', 'tmp/hallo/**/*.js', 'tmp/hallo/**/**/*.js'],
        dest: '../js/exo.hallo.js'
      },
      exo: {
        src: ['tmp/exo/*.js'],
        dest: '../js/exo.js'
      }
    },
    clean: ['tmp', 'exo/*.js', 'hallo/*.js', 'hallo/*/*.js'],
    uglify: {
      options: {
        banner: banner,
        report: 'min'
      },
      full: {
        files: {
          '../js/exo.hallo.min.js': ['../js/exo.hallo.js'],
          '../js/exo.min.js': ['../js/exo.js']
        }
      }
    },
    coffeelint: {
      full: ['hallo/*.coffee', 'hallo/**/*.coffee', 'exo/*.coffee']
    },
    qunit: {
      all: ['test/*.html']
    },
    connect: {
      server: {
        options: {
          base: '',
          port: 9999
        }
      }
    },
    'saucelabs-qunit': {
      all: {
        options: {
          urls: ['http://127.0.0.1:9999/test/index.html'],
          browsers: [
            {
              browserName: 'chrome'
            }, {
              browserName: 'safari',
              platform: 'OS X 10.8',
              version: '6'
            }
          ],
          build: process.env.TRAVIS_JOB_ID,
          testname: 'hallo.js cross-browser tests',
          tunnelTimeout: 5,
          concurrency: 3,
          detailedError: true
        }
      }
    }
  });
  this.loadNpmTasks('grunt-bower-task');
  this.loadNpmTasks('grunt-contrib-coffee');
  this.loadNpmTasks('grunt-contrib-watch');
  this.loadNpmTasks('grunt-contrib-concat');
  this.loadNpmTasks('grunt-contrib-clean');
  this.loadNpmTasks('grunt-contrib-uglify');
  this.loadNpmTasks('grunt-coffeelint');
  this.loadNpmTasks('grunt-contrib-jshint');
  this.loadNpmTasks('grunt-contrib-qunit');
  this.loadNpmTasks('grunt-contrib-connect');
  this.loadNpmTasks('grunt-saucelabs');
  this.registerTask('build', ['coffee', 'concat', 'clean', 'uglify']);
  this.registerTask('test', ['coffeelint', 'build', 'qunit']);
  return this.registerTask('crossbrowser', ['test', 'connect', 'saucelabs-qunit']);
};
